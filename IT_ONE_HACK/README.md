# Система правил #

## Типы поддерживаемых правил: ##

### Threshold (Пороговое правило): ###
_Проверяет, превышает ли значение определённого поля транзакции заданный порог._

**Пример:** если сумма транзакции больше 100 000 рублей, операция считается подозрительной.

**Параметры:**  поле для проверки, оператор сравнения, пороговое значение.

### Pattern (Поведенческое правило):
_Анализирует последовательность транзакций по заданному шаблону._

**Пример:** если за последние 5 минут с одного счёта было совершено 3 и более транзакций на сумму менее 1 000 рублей, это может указывать на мошенничество.

**Параметры:** количество транзакций, максимальная сумма, временной интервал.

### Composite (Составное правило):
_Объединяет несколько базовых правил с помощью логических операторов (AND, OR)._

**Пример:** транзакция считается подозрительной, если сумма больше 50 000 рублей и операция проводится ночью.

**Параметры:** список базовых правил, логика объединения (AND/OR).

### ML Rule (Машинное обучение):

_Использует предобученную модель машинного обучения для оценки вероятности мошенничества._

**Пример:** модель анализирует признаки транзакции и возвращает вероятность мошенничества; если она превышает заданный порог, операция помечается как подозрительная.

**Параметры:** путь к модели, список признаков, порог вероятности.

## Загрузка правил:

-При запуске сервиса все активные правила загружаются из базы данных (PostqreSQL).

-Каждое правило преобразуется в объект соответствующего класса на основе типа.

-Все объекты правил хранятся в памяти для быстрого доступа.

-При изменении правил через административную панель объекты обновляются в памяти без перезапуска приложения.

## Выполнение правил:

-Для каждой поступающей транзакции движок правил последовательно применяет все активные правила.

-Каждый модуль реализует метод проверки, который возвращает результат анализа.

-Composite Rule может использовать результаты других правил для сложной логики.

-ML Rule вызывает предобученную модель и сравнивает вероятность с заданным порогом.

## Порядок выполнения:

-Правила применяются в порядке приоритета, заданного в базе данных.

-Все активные правила проверяются для каждой транзакции.

-Если хотя бы одно правило срабатывает, транзакция помечается как подозрительная.

Роль:  Backend Developer (База данных и бизнес-логика)
Что я сделал:
База данных
Создал все модели для хранения данных: транзакции, правила, результаты проверок

Настроил связи между таблицами и добавил индексы для быстрого поиска

Сделал автоматическое создание таблиц при запуске

Основные функции
Сервис для работы с транзакциями (добавление, поиск, обновление)

Система проверки транзакций по анти-фрод правилам

Сохранение результатов проверки каждой транзакции

Аналитика и статистика по всем операциям

Дополнительные системы
История изменений правил (кто и когда менял)

Аудит действий администраторов

Система бэкапа правил в JSON файлы

Генерация уникальных ID для отслеживания транзакций

Проверка работы
Написал тесты для всех функций

Проверил что всё работает вместе

Убедился что данные сохраняются правильно

Результат: Полностью рабочая backend система для обработки финансовых транзакций с проверкой на мошенничество.